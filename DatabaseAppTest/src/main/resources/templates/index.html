<!DOCTYPE html>
<html lang="cs" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/layout.html :: head(pageTitle='Datab√°ze')}"></head>

<body class="d-flex flex-column min-vh-100">

<header th:replace="~{fragments/layout.html :: header}"></header>
<!-- Success Message -->
<div th:if="${successMessage}" class="alert alert-success p-0 text-center mb-1 rounded-0" role="alert">
    <span th:utext="${successMessage}"></span>
</div>

<div class="container mt-3">
    <!-- Search and Add User Button -->
    <div class="d-flex align-items-center mt-2 mb-1">
        <a id="novyUzivatel" class="btn btn-primary" th:href="@{createUzivatel}">P≈ôidat üë®üèº‚Äç‚öïÔ∏è</a>

        <!-- Form with responsive input field -->
        <form th:action="@{/index}" method="get" class="d-flex ms-3 btn-group" role="group" aria-label="Basic example">
            <!-- Use Bootstrap's grid system to limit input size on larger screens -->
            <div class="input-group">
                <input id="hledej" name="hledej" type="text" placeholder="Hledej" class="form-control"
                       style="max-width: 300px;">
                <button type="submit" class="btn btn-sm btn-light">üîç</button>
                <a th:href="@{index}" class="btn btn-sm btn-light px-2 py-2">Reset</a>
            </div>
        </form>
    </div>

    <!-- Zobrazen√≠ poƒçtu z√°znam≈Ø v tabulce -->
    <div class="text-end ms-auto me-0 my-0">
        <small th:if="${uzivatelePage != null && !uzivatelePage.isEmpty()}" class="pocet-zaznamu text-light d-inline-block my-0 px-2">
            Z√°znam≈Ø celkem: <strong><span th:text="${uzivatelePage.totalElements}" class="fs-5"></span></strong>
        </small>

        <small th:if="${uzivatelePage == null || uzivatelePage.isEmpty()}" class="pocet-zaznamu text-light d-inline-block my-0 px-2">
            ≈Ω√°dn√© z√°znamy nebyly nalezeny!
        </small>
    </div>

    <!-- Table -->
    <div class="table-responsive">
        <table class="table table-striped table-bordered mb-1 mt-2">
            <thead>
            <tr>
                <th class="bg-dark-subtle text-nowrap">ID
                    <a th:href="@{|/index?page=${currentPage}&sort=id,asc|}"
                       th:classappend="${sort} == 'id,asc' ? 'active-sort' : ''">‚¨áÔ∏è</a>
                    <a th:href="@{|/index?page=${currentPage}&sort=id,desc|}"
                       th:classappend="${sort} == 'id,desc' ? 'active-sort' : ''">‚¨ÜÔ∏è</a>
                </th>
                <th class="bg-dark-subtle text-nowrap">Jm√©no
                    <a th:href="@{|/index?page=${currentPage}&sort=jmeno,asc|}"
                       th:classappend="${sort} == 'jmeno,asc' ? 'active-sort' : ''">‚¨áÔ∏è</a>
                    <a th:href="@{|/index?page=${currentPage}&sort=jmeno,desc|}"
                       th:classappend="${sort} == 'jmeno,desc' ? 'active-sort' : ''">‚¨ÜÔ∏è</a>
                </th>
                <th class="bg-dark-subtle text-nowrap">P≈ô√≠jmen√≠
                    <a th:href="@{|/index?page=${currentPage}&sort=prijmeni,asc|}"
                       th:classappend="${sort} == 'prijmeni,asc' ? 'active-sort' : ''">‚¨áÔ∏è</a>
                    <a th:href="@{|/index?page=${currentPage}&sort=prijmeni,desc|}"
                       th:classappend="${sort} == 'prijmeni,desc' ? 'active-sort' : ''">‚¨ÜÔ∏è</a>
                </th>
                <th class="bg-dark-subtle text-nowrap">üì™ E-mail</th>
                <th class="bg-dark-subtle text-center text-nowrap">üìû Telefon</th>
                <th class="bg-dark-subtle text-center text-nowrap">Vytvo≈ôen
                    <a th:href="@{|/index?page=${currentPage}&sort=vytvoren,asc|}"
                       th:classappend="${sort} == 'vytvoren,asc' ? 'active-sort' : ''">‚¨áÔ∏è</a>
                    <a th:href="@{|/index?page=${currentPage}&sort=vytvoren,desc|}"
                       th:classappend="${sort} == 'vytvoren,desc' ? 'active-sort' : ''">‚¨ÜÔ∏è</a>
                </th>
                <th class="bg-dark-subtle text-center text-nowrap">üîß Akce</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${uzivatelePage != null && !uzivatelePage.isEmpty()}" th:each="uzivatel : ${uzivatelePage.content}">
                <td th:text="${uzivatel.id}" class="text-center"></td>
                <td th:text="${uzivatel.jmeno}"></td>
                <td th:text="${uzivatel.prijmeni}"></td>
                <td th:text="${uzivatel.email}"></td>
                <td th:text="${uzivatel.telefon}" class="text-center"></td>
                <td th:text="${uzivatel.vytvoren != null ? uzivatel.vytvoren.format(T(java.time.format.DateTimeFormatter).ofPattern('dd.MM.yyyy')) : ''}"
                    class="text-center"></td>
                <td>
                    <div class="d-flex justify-content-center">
                        <a th:href="@{/updateUzivatel/{id}(id=${uzivatel.id})}"
                           class="btn btn-sm btn-success p-1 me-1">upravit</a>
                        <form th:action="@{/deleteUzivatel/{id}(id=${uzivatel.id})}" method="post"
                              onsubmit="return confirm('Opravdu chcete tento z√°znam smazat?');">
                            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
                            <button type="submit" class="btn btn-sm btn-danger p-1">odstranit</button>
                        </form>
                    </div>
                </td>
            </tr>
            <tr th:if="${uzivatelePage == null || uzivatelePage.isEmpty()}">
                <td colspan="7" class="text-center">≈Ω√°dn√≠ u≈æivatel√© nebyli nalezeni.</td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="pagination badge">
        <a th:href="@{|/index?page=${currentPage - 1}&sort=${sort}|}" th:if="${uzivatelePage != null && uzivatelePage.hasPrevious()}"
           class="text-light me-1 text-decoration-none">‚óÄÔ∏é</a>
        <small style="font-weight: normal;">Str√°nka [[${currentPage + 1}]] z [[${uzivatelePage != null ? uzivatelePage.totalPages : 1}]]</small>
        <a th:href="@{|/index?page=${currentPage + 1}&sort=${sort}|}" th:if="${uzivatelePage != null && uzivatelePage.hasNext()}"
           class="text-light ms-1 text-decoration-none">‚ñ∂Ô∏é</a>
    </div>
</div>

<!-- Description Section -->
<div class="popis-div container col-11 col-md-8 bg-info-subtle rounded-3 mt-3">
    <p class="popis m-2 fs-6 px-2">POPIS: Tato aplikace je komplexn√≠ webov√Ω syst√©m pro spr√°vu a evidenci u≈æivatel≈Ø,
        vyvinut√Ω za
        √∫ƒçelem usnadnƒõn√≠ spr√°vy dat. Umo≈æ≈àuje u≈æivatel≈Øm p≈ôid√°vat, upravovat, mazat a vyhled√°vat z√°znamy v datab√°zi.
        Aplikace je navr≈æena tak, aby byla intuitivn√≠ a u≈æivatelsky p≈ô√≠vƒõtiv√°, s modern√≠m rozhran√≠m, kter√© umo≈æ≈àuje
        efektivn√≠ a rychlou pr√°ci s daty.
    </p>
</div>
<div class="mx-2">
    <p class="text-light text-center mt-1">
        <small>(V≈°echny kontakty jsou vymy≈°len√©, pouze pro v√Ωvoj a testov√°n√≠ webov√© aplikace)</small>
    </p>
</div>

<footer th:replace="~{fragments/layout.html :: footer}"></footer>

<script th:replace="~{fragments/layout.html :: helpText}"></script>
</body>
</html>
